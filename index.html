<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CashFlow 2.0 - Advanced Money Tracker</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Language Toggle (visible on all screens) -->
    <button class="lang-toggle" id="langToggle">ÌïúÍµ≠Ïñ¥</button>

    <!-- Onboarding Screen -->
    <div id="onboarding" class="screen">
        <div class="onboarding-container">
            <h1>üí∞ CashFlow 2.0</h1>
            <p class="tagline" data-i18n="tagline">Watch your money grow in real-time</p>

            <!-- Welcome Step -->
            <div class="onboarding-step" id="step0">
                <div class="welcome-features">
                    <div class="welcome-item">
                        <span class="welcome-icon">üîí</span>
                        <div class="welcome-text">
                            <strong data-i18n="welcome_privacy_title">100% Private</strong>
                            <p data-i18n="welcome_privacy_desc">Your data never leaves your device. No trackers, no servers, no accounts.</p>
                        </div>
                    </div>
                    <div class="welcome-item">
                        <span class="welcome-icon">üí∏</span>
                        <div class="welcome-text">
                            <strong data-i18n="welcome_flow_title">Constant Cashflow</strong>
                            <p data-i18n="welcome_flow_desc">Your salary flows in 24/7. Watch your balance tick up every second you exist.</p>
                        </div>
                    </div>
                    <div class="welcome-item">
                        <span class="welcome-icon">üéÆ</span>
                        <div class="welcome-text">
                            <strong data-i18n="welcome_game_title">Gamify Saving</strong>
                            <p data-i18n="welcome_game_desc">Track expenses, beat your budget, and watch your wealth grow in real-time.</p>
                        </div>
                    </div>
                </div>
                <button class="next-btn" id="toStep1" data-i18n="get_started">Get Started ‚Üí</button>
            </div>

            <div class="onboarding-step hidden" id="step1">
                <h2 data-i18n="whats_salary">What's your salary?</h2>
                <div class="input-group">
                    <span class="currency">$</span>
                    <input type="number" id="salaryInput" placeholder="0" min="0">
                </div>
                <div class="toggle-group">
                    <button class="toggle-btn active" data-period="annual" data-i18n="annual">Annual</button>
                    <button class="toggle-btn" data-period="monthly" data-i18n="monthly">Monthly</button>
                </div>
                <button class="next-btn" id="toStep2" data-i18n="next">Next ‚Üí</button>
            </div>

            <div class="onboarding-step hidden" id="step2">
                <h2 data-i18n="cash_on_hand">Current cash on hand?</h2>
                <p class="hint" data-i18n="cash_hint">Bank accounts, savings, etc.</p>
                <div class="input-group">
                    <span class="currency">$</span>
                    <input type="number" id="cashInput" placeholder="0" min="0">
                </div>
                <button class="next-btn" id="toStep3" data-i18n="next">Next ‚Üí</button>
            </div>

            <div class="onboarding-step hidden" id="step3">
                <h2 data-i18n="tax_info">Tax Information</h2>
                <p class="hint" data-i18n="tax_hint">For accurate calculations</p>

                <label class="select-label" data-i18n="country">Country</label>
                <select id="countrySelect">
                    <option value="us" data-i18n="country_us">United States (USD)</option>
                    <option value="kr" data-i18n="country_kr">South Korea (KRW)</option>
                </select>

                <div id="usTaxFields">
                    <label class="select-label" data-i18n="filing_status">Filing Status</label>
                    <select id="filingStatus">
                        <option value="single" data-i18n="single">Single</option>
                        <option value="married" data-i18n="married">Married Filing Jointly</option>
                        <option value="head" data-i18n="head_household">Head of Household</option>
                    </select>

                    <label class="select-label" data-i18n="state">State</label>
                    <select id="stateSelect">
                        <option value="0" data-i18n="no_state_tax">No State Tax (TX, FL, etc.)</option>
                        <option value="0.0499" data-i18n="low_tax">Low (‚âà5% - AZ, CO, etc.)</option>
                        <option value="0.0725" data-i18n="medium_tax">Medium (‚âà7% - GA, NC, etc.)</option>
                        <option value="0.0975" data-i18n="high_tax">High (‚âà10% - CA, NJ, etc.)</option>
                        <option value="0.1275" data-i18n="very_high_tax">Very High (‚âà13% - CA top bracket)</option>
                    </select>
                </div>

                <label class="select-label" data-i18n="salary_start_date">When did this salary start?</label>
                <input type="date" id="salaryStartDate" class="date-input">

                <button class="start-btn" id="startApp" data-i18n="start_earning">Start Earning! üöÄ</button>
            </div>
        </div>
    </div>

    <!-- Main App Screen -->
    <div id="mainApp" class="screen hidden">
        <!-- Header with balance -->
        <header class="balance-header">
            <p class="balance-label" data-i18n="current_balance">Current Balance</p>
            <h1 class="balance-amount" id="balanceDisplay">$0.00</h1>
            <div class="rate-row">
                <div class="earning-rate">
                    <span class="pulse"></span>
                    <span id="earningRate">+$0.00/sec</span>
                </div>
                <div class="bleeding-rate">
                    <span class="pulse red"></span>
                    <span id="bleedingRate">-$0.00/sec</span>
                </div>
            </div>
        </header>

        <!-- Period Selector -->
        <div class="period-selector-row">
            <label data-i18n="view_period">View Period</label>
            <select id="periodSelector">
                <option value="day" data-i18n="today">Today</option>
                <option value="week" data-i18n="this_week">This Week</option>
                <option value="month" data-i18n="this_month">This Month</option>
                <option value="year" data-i18n="this_year">This Year</option>
                <option value="all" data-i18n="since_start">Since Start</option>
            </select>
        </div>

        <!-- Stats Row -->
        <div class="stats-row">
            <div class="stat-card">
                <span class="stat-label" id="periodLabel" data-i18n="today">Today</span>
                <span class="stat-value positive" id="periodEarned">+$0</span>
            </div>
            <div class="stat-card">
                <span class="stat-label" data-i18n="taxes_period">Taxes</span>
                <span class="stat-value negative" id="periodTaxes">-$0</span>
            </div>
            <div class="stat-card">
                <span class="stat-label" data-i18n="expenses_period">Spent</span>
                <span class="stat-value negative" id="periodExpenses">-$0</span>
            </div>
            <div class="stat-card">
                <span class="stat-label" data-i18n="net_worth">Net Worth</span>
                <span class="stat-value" id="netWorth">$0</span>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <button class="action-btn expense-btn" id="addExpenseBtn">
                <span class="icon">‚àí</span>
                <span data-i18n="add_expense">Add Expense</span>
            </button>
            <button class="action-btn income-btn" id="addIncomeBtn">
                <span class="icon">+</span>
                <span data-i18n="add_income">Add Income</span>
            </button>
        </div>

        <!-- Navigation Tabs -->
        <nav class="tab-nav">
            <button class="tab-btn active" data-tab="chart"><span>üìä</span></button>
            <button class="tab-btn" data-tab="transactions"><span>üìù</span></button>
            <button class="tab-btn" data-tab="budget"><span>üí°</span></button>
            <button class="tab-btn" data-tab="savings"><span>üè¶</span></button>
            <button class="tab-btn" data-tab="debts"><span>üí≥</span></button>
            <button class="tab-btn" data-tab="settings"><span>‚öôÔ∏è</span></button>
        </nav>

        <!-- Tab Content -->
        <div class="tab-content">
            <!-- Chart Tab -->
            <div class="tab-panel active" id="chartPanel">
                <div class="chart-controls">
                    <select id="chartPeriod">
                        <option value="day" data-i18n="today">Today</option>
                        <option value="week" selected data-i18n="this_week">This Week</option>
                        <option value="month" data-i18n="this_month">This Month</option>
                        <option value="year" data-i18n="this_year">This Year</option>
                    </select>
                    <div class="chart-toggles">
                        <label class="toggle-label">
                            <input type="checkbox" id="showIncome" checked>
                            <span class="toggle-dot income"></span> <span data-i18n="income">Income</span>
                        </label>
                        <label class="toggle-label">
                            <input type="checkbox" id="showExpenses" checked>
                            <span class="toggle-dot expenses"></span> <span data-i18n="expenses">Expenses</span>
                        </label>
                        <label class="toggle-label">
                            <input type="checkbox" id="showTaxes" checked>
                            <span class="toggle-dot taxes"></span> <span data-i18n="taxes">Taxes</span>
                        </label>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="mainChart"></canvas>
                </div>
            </div>

            <!-- Transactions Tab -->
            <div class="tab-panel" id="transactionsPanel">
                <div class="transactions-list" id="transactionsList">
                    <p class="empty-state" data-i18n="no_transactions">No transactions yet</p>
                </div>
            </div>

            <!-- Budget Tab -->
            <div class="tab-panel" id="budgetPanel">
                <div class="budget-summary">
                    <h3>üí° <span data-i18n="smart_budget">Smart Budget Suggestions</span></h3>
                    <p class="budget-intro"><span data-i18n="based_on_income">Based on your income of</span> <span id="budgetIncome">$0</span><span data-i18n="per_month">/month</span></p>
                </div>

                <div class="budget-cards">
                    <div class="budget-card">
                        <div class="budget-header">
                            <span class="budget-icon">üìÖ</span>
                            <h4 data-i18n="daily_budget">Daily Budget</h4>
                        </div>
                        <div class="budget-amounts">
                            <div class="budget-row">
                                <span data-i18n="spending_limit">Spending Limit</span>
                                <span class="amount" id="dailySpend">$0</span>
                            </div>
                            <div class="budget-row">
                                <span data-i18n="savings_target">Savings Target</span>
                                <span class="amount positive" id="dailySave">$0</span>
                            </div>
                        </div>
                    </div>

                    <div class="budget-card">
                        <div class="budget-header">
                            <span class="budget-icon">üìÜ</span>
                            <h4 data-i18n="weekly_budget">Weekly Budget</h4>
                        </div>
                        <div class="budget-amounts">
                            <div class="budget-row">
                                <span data-i18n="spending_limit">Spending Limit</span>
                                <span class="amount" id="weeklySpend">$0</span>
                            </div>
                            <div class="budget-row">
                                <span data-i18n="savings_target">Savings Target</span>
                                <span class="amount positive" id="weeklySave">$0</span>
                            </div>
                        </div>
                    </div>

                    <div class="budget-card">
                        <div class="budget-header">
                            <span class="budget-icon">üóìÔ∏è</span>
                            <h4 data-i18n="monthly_budget">Monthly Budget</h4>
                        </div>
                        <div class="budget-amounts">
                            <div class="budget-row">
                                <span data-i18n="spending_limit">Spending Limit</span>
                                <span class="amount" id="monthlySpend">$0</span>
                            </div>
                            <div class="budget-row">
                                <span data-i18n="savings_target">Savings Target</span>
                                <span class="amount positive" id="monthlySave">$0</span>
                            </div>
                            <div class="budget-row">
                                <span data-i18n="emergency_fund">Emergency Fund Goal</span>
                                <span class="amount" id="emergencyFund">$0</span>
                            </div>
                        </div>
                    </div>

                    <div class="budget-card highlight">
                        <div class="budget-header">
                            <span class="budget-icon">üéØ</span>
                            <h4 data-i18n="rule_503020">50/30/20 Rule</h4>
                        </div>
                        <div class="budget-amounts">
                            <div class="budget-row">
                                <span data-i18n="needs">Needs (50%)</span>
                                <span class="amount" id="needsAmount">$0</span>
                            </div>
                            <div class="budget-row">
                                <span data-i18n="wants">Wants (30%)</span>
                                <span class="amount" id="wantsAmount">$0</span>
                            </div>
                            <div class="budget-row">
                                <span data-i18n="savings_20">Savings (20%)</span>
                                <span class="amount positive" id="budgetSavingsAmount">$0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="progress-section">
                    <h4 data-i18n="month_progress">This Month's Progress</h4>
                    <div class="progress-item">
                        <div class="progress-label">
                            <span data-i18n="spending">Spending</span>
                            <span id="spendProgress">$0 / $0</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill spending" id="spendBar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <div class="progress-label">
                            <span data-i18n="savings">Savings</span>
                            <span id="saveProgress">$0 / $0</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill saving" id="saveBar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Savings Tab -->
            <div class="tab-panel" id="savingsPanel">
                <div class="savings-header">
                    <h3>üè¶ <span data-i18n="savings_balance">Savings Balance</span></h3>
                    <div class="savings-balance" id="savingsBalanceDisplay">$0.00</div>
                </div>

                <div class="savings-actions">
                    <div class="input-group small">
                        <span class="currency">$</span>
                        <input type="number" id="savingsAmount" placeholder="0.00" min="0" step="0.01">
                    </div>
                    <div class="savings-buttons">
                        <button class="action-btn income-btn small" id="transferToSavings" data-i18n="transfer_to_savings">Transfer</button>
                        <button class="action-btn expense-btn small" id="withdrawFromSavings" data-i18n="withdraw_from_savings">Withdraw</button>
                    </div>
                </div>

                <div class="savings-history">
                    <h4 data-i18n="savings_history">Transfer History</h4>
                    <div class="transactions-list" id="savingsHistoryList">
                        <p class="empty-state" data-i18n="no_savings_history">No transfers yet</p>
                    </div>
                </div>
            </div>

            <!-- Debts Tab -->
            <div class="tab-panel" id="debtsPanel">
                <div class="debts-header">
                    <h3>üí≥ <span data-i18n="total_debt">Total Debt</span></h3>
                    <div class="total-debt negative" id="totalDebtDisplay">$0.00</div>
                </div>

                <button class="action-btn add-debt-btn" id="addDebtBtn">
                    <span class="icon">+</span>
                    <span data-i18n="add_debt">Add Debt/Loan</span>
                </button>

                <div class="debts-list" id="debtsList">
                    <p class="empty-state" data-i18n="no_debts">No debts - you're debt free!</p>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-panel" id="settingsPanel">
                <div class="settings-list">
                    <div class="settings-item">
                        <label data-i18n="country">Country</label>
                        <select id="settingsCountry">
                            <option value="us" data-i18n="country_us">United States (USD)</option>
                            <option value="kr" data-i18n="country_kr">South Korea (KRW)</option>
                        </select>
                    </div>
                    <div class="settings-item">
                        <label data-i18n="current_salary">Current Salary</label>
                        <div class="input-group small">
                            <span class="currency" id="settingsCurrencySymbol">$</span>
                            <input type="number" id="settingsSalary" placeholder="0">
                        </div>
                    </div>

                    <!-- Salary History Section -->
                    <div class="settings-item salary-section">
                        <label data-i18n="salary_history">Salary History</label>
                        <div id="salaryHistoryList" class="salary-history-list"></div>

                        <div class="salary-change-form">
                            <h5 data-i18n="add_salary_change">Record Salary Change</h5>
                            <div class="input-group small">
                                <span class="currency">$</span>
                                <input type="number" id="newSalaryAmount" data-i18n-placeholder="new_salary" placeholder="New Salary Amount">
                            </div>
                            <label class="select-label" data-i18n="effective_date">Effective Date</label>
                            <input type="date" id="salaryEffectiveDate" class="date-input">
                            <button class="save-settings-btn small" id="addSalaryChange" data-i18n="add">Add</button>
                        </div>
                    </div>

                    <div id="settingsUsTaxFields">
                        <div class="settings-item">
                            <label data-i18n="filing_status">Filing Status</label>
                            <select id="settingsFilingStatus">
                                <option value="single" data-i18n="single">Single</option>
                                <option value="married" data-i18n="married">Married Filing Jointly</option>
                                <option value="head" data-i18n="head_household">Head of Household</option>
                            </select>
                        </div>
                        <div class="settings-item">
                            <label data-i18n="state_tax_rate">State Tax Rate</label>
                            <select id="settingsStateTax">
                                <option value="0" data-i18n="no_state_tax_short">No State Tax</option>
                                <option value="0.0499" data-i18n="low_tax_short">Low (‚âà5%)</option>
                                <option value="0.0725" data-i18n="medium_tax_short">Medium (‚âà7%)</option>
                                <option value="0.0975" data-i18n="high_tax_short">High (‚âà10%)</option>
                                <option value="0.1275" data-i18n="very_high_tax_short">Very High (‚âà13%)</option>
                            </select>
                        </div>
                    </div>
                    <div class="settings-item">
                        <label data-i18n="savings_goal">Savings Goal (%)</label>
                        <input type="range" id="savingsGoal" min="5" max="50" value="20">
                        <span id="savingsGoalValue">20%</span>
                    </div>
                    <div class="settings-item">
                        <label data-i18n="language">Language</label>
                        <select id="languageSelect">
                            <option value="en">English</option>
                            <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                        </select>
                    </div>
                    <button class="save-settings-btn" id="saveSettings" data-i18n="save_settings">Save Settings</button>
                    <button class="reset-btn" id="resetData" data-i18n="reset_data">Reset All Data</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Expense/Income Modal -->
    <div class="modal-overlay hidden" id="transactionModal">
        <div class="modal">
            <h3 id="modalTitle" data-i18n="add_expense">Add Expense</h3>
            <div class="input-group">
                <span class="currency">$</span>
                <input type="number" id="transactionAmount" placeholder="0.00" min="0" step="0.01">
            </div>
            <input type="text" id="transactionNote" data-i18n-placeholder="note_optional" placeholder="Note (optional)" class="note-input">
            <select id="transactionCategory">
                <option value="food" data-i18n="cat_food">üçî Food & Dining</option>
                <option value="transport" data-i18n="cat_transport">üöó Transportation</option>
                <option value="shopping" data-i18n="cat_shopping">üõçÔ∏è Shopping</option>
                <option value="bills" data-i18n="cat_bills">üìÑ Bills & Utilities</option>
                <option value="entertainment" data-i18n="cat_entertainment">üé¨ Entertainment</option>
                <option value="health" data-i18n="cat_health">üíä Health</option>
                <option value="other" data-i18n="cat_other">üì¶ Other</option>
            </select>
            <div class="modal-buttons">
                <button class="cancel-btn" id="cancelTransaction" data-i18n="cancel">Cancel</button>
                <button class="confirm-btn" id="confirmTransaction" data-i18n="add">Add</button>
            </div>
        </div>
    </div>

    <!-- Edit Transaction Modal -->
    <div class="modal-overlay hidden" id="editModal">
        <div class="modal">
            <h3 data-i18n="edit_transaction">Edit Transaction</h3>
            <div class="input-group">
                <span class="currency">$</span>
                <input type="number" id="editAmount" placeholder="0.00" min="0" step="0.01">
            </div>
            <input type="text" id="editNote" data-i18n-placeholder="note_optional" placeholder="Note (optional)" class="note-input">
            <select id="editCategory">
                <option value="food" data-i18n="cat_food">üçî Food & Dining</option>
                <option value="transport" data-i18n="cat_transport">üöó Transportation</option>
                <option value="shopping" data-i18n="cat_shopping">üõçÔ∏è Shopping</option>
                <option value="bills" data-i18n="cat_bills">üìÑ Bills & Utilities</option>
                <option value="entertainment" data-i18n="cat_entertainment">üé¨ Entertainment</option>
                <option value="health" data-i18n="cat_health">üíä Health</option>
                <option value="other" data-i18n="cat_other">üì¶ Other</option>
            </select>
            <div class="date-input-group">
                <label data-i18n="transaction_date">Date</label>
                <input type="datetime-local" id="editDate">
            </div>
            <div class="modal-buttons">
                <button class="delete-btn" id="deleteTransaction" data-i18n="delete">Delete</button>
                <button class="cancel-btn" id="cancelEdit" data-i18n="cancel">Cancel</button>
                <button class="confirm-btn" id="saveEdit" data-i18n="save">Save</button>
            </div>
        </div>
    </div>

    <!-- Add Debt Modal -->
    <div class="modal-overlay hidden" id="debtModal">
        <div class="modal">
            <h3 data-i18n="add_debt">Add Debt/Loan</h3>
            <input type="text" id="debtName" data-i18n-placeholder="debt_name" placeholder="Name (e.g., Credit Card, Car Loan)" class="note-input">
            <div class="input-group">
                <span class="currency">$</span>
                <input type="number" id="debtPrincipal" data-i18n-placeholder="principal" placeholder="Principal Amount" min="0" step="0.01">
            </div>
            <div class="input-group">
                <span class="percent-symbol">%</span>
                <input type="number" id="debtRate" data-i18n-placeholder="interest_rate" placeholder="Annual Interest Rate" min="0" max="100" step="0.01">
            </div>
            <div class="modal-buttons">
                <button class="cancel-btn" id="cancelDebt" data-i18n="cancel">Cancel</button>
                <button class="confirm-btn" id="confirmDebt" data-i18n="add">Add</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // Register service worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed:', err));
            });
        }
    </script>
</body>
</html>
